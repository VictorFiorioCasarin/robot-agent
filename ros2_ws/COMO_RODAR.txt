# Como Rodar o Robot Agent com ROS2

## üìã Pr√©-requisitos

### 1. Sistema
- Ubuntu com ROS2 Humble instalado
- Python 3.10+
- Ollama instalado

### 2. Depend√™ncias Python
```bash
pip install -U langchain-ollama langchain-core pyyaml requests
```

## üöÄ Passos para Execu√ß√£o

### 1. Preparar o Ollama
**IMPORTANTE**: Sempre execute estes passos primeiro!

```bash
# Verificar se o Ollama est√° rodando na porta 11434
sudo lsof -i :11434

# Se estiver rodando, matar o processo (substitua XXX pelo PID mostrado)
kill XXX

# Iniciar o Ollama em terminal (para ver logs)
ollama serve

# Em outro terminal, verificar se o modelo est√° instalado
ollama list

# Se n√£o tiver o gemma3:4b, instalar:
ollama pull gemma3:4b
```

### 2. Preparar o Workspace ROS2
```bash
cd ~/ros2_ws

# Configurar ambiente ROS2
source /opt/ros/humble/setup.bash

# Compilar o pacote robot_agent
colcon build --packages-select robot_agent

# Configurar ambiente do workspace
source install/setup.bash
```

### 3. Executar o Sistema

#### Op√ß√£o A: Sistema Completo (Router + Agentes)
```bash
cd /home/victor/teste_ros/ros2_ws
source /opt/ros/humble/setup.bash
source install/setup.bash
python3 router.py
```

#### Op√ß√£o B: Apenas Testes das Ferramentas ROS2
```bash
cd /home/victor/teste_ros/ros2_ws
source /opt/ros/humble/setup.bash
source install/setup.bash
python3 src/robot_agent/robot_tools.py
```

### 4. Monitorar ROS2 (Opcional)
Em terminal separado:
```bash
cd ~/ros2_ws
source /opt/ros/humble/setup.bash
source install/setup.bash

# Monitorar todos os t√≥picos
python3 simple_room_subscriber.py

# OU monitorar apenas o t√≥pico 'room' com comando ROS2
ros2 topic echo /room
```

## üîß Solu√ß√£o de Problemas

### Erro: "model gemma3:4b not found"
```bash
# Verificar modelos dispon√≠veis
ollama list

# Instalar o modelo se necess√°rio
ollama pull gemma3:4b
```

### Erro: "Cannot connect to Ollama"
```bash
# Verificar se o Ollama est√° rodando
sudo lsof -i :11434

# Se n√£o estiver, iniciar:
ollama serve
```

### Erro: "ROS2 command not found"
```bash
# Configurar ambiente ROS2
source /opt/ros/humble/setup.bash
```

### Erro: "robot_agent package not found"
```bash
# Recompilar o pacote
cd /home/victor/teste_ros/ros2_ws
colcon build --packages-select robot_agent
source install/setup.bash
```

### Erro de import do LangChain
```bash
# Reinstalar depend√™ncias
pip install -U langchain-ollama langchain-core
```


## üìä Estrutura dos Arquivos

```
ros2_ws/
‚îú‚îÄ‚îÄ router.py              # Ponto de entrada principal
‚îú‚îÄ‚îÄ main_robot_agent.py    # Agente de comandos
‚îú‚îÄ‚îÄ conversation_agent.py  # Agente de conversa√ß√£o
‚îú‚îÄ‚îÄ ros2_monitor.py        # Monitor de t√≥picos ROS2
‚îî‚îÄ‚îÄ src/robot_agent/robot_agent/
    ‚îî‚îÄ‚îÄ robot_tools.py     # Ferramentas do rob√¥ com ROS2
```

## ‚ö†Ô∏è Cuidados Importantes

1. **Sempre iniciar o Ollama primeiro** e verificar se est√° funcionando
2. **Compilar o workspace** com `colcon build` ap√≥s mudan√ßas
3. **Configurar ambiente** com `source` nos comandos antes de executar
4. **Verificar depend√™ncias** se houver erros de import
5. **Usar Ctrl+C** para parar processos em execu√ß√£o
6. **Fechar o Ollama** com `kill PID` se necess√°rio

## üéØ Fluxo Normal de Uso

1. Abrir terminal 1: Iniciar Ollama (`ollama serve`)
2. Abrir terminal 2: Executar sistema (`python3 router.py`)
3. Abrir terminal 3 (opcional): Monitor ROS2 (`python3 ros2_monitor.py`)
4. Interagir com o rob√¥ atrav√©s do terminal 2
5. Observar mensagens ROS2 no terminal 3

